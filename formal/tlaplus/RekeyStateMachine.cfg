\* TLC Configuration for RekeyStateMachine.tla
\* NOMAD Rekey State Machine Verification

CONSTANTS
    REKEY_AFTER_TIME = 3
    REJECT_AFTER_TIME = 5
    OLD_KEY_RETENTION = 1
    MAX_EPOCH = 4
    REKEY_AFTER_MESSAGES = 10
    REJECT_AFTER_MESSAGES = 15
    MaxTime = 20

SPECIFICATION Spec

INVARIANTS
    TypeOK
    Safety
    MonotonicEpochs
    KeysMatchEpoch
    OldKeysFromPreviousEpoch
    NonceUniqueness

PROPERTIES
    RekeyEventuallyHappens
    NoForeverWaiting
