\* TLC Configuration for RekeyStateMachine.tla
\* NOMAD Rekey State Machine Verification

\* Disable deadlock checking - model terminates when time reaches MaxTime
\* or keys expire, which is expected behavior
CHECK_DEADLOCK FALSE

CONSTANTS
    \* Reduced for faster verification - increase for thorough check
    REKEY_AFTER_TIME = 2
    REJECT_AFTER_TIME = 3
    OLD_KEY_RETENTION = 1
    MAX_EPOCH = 2
    REKEY_AFTER_MESSAGES = 5
    REJECT_AFTER_MESSAGES = 8
    MaxTime = 10

SPECIFICATION Spec

INVARIANTS
    TypeOK
    Safety
    MonotonicEpochs
    KeysMatchEpoch
    OldKeysFromPreviousEpoch
    NonceUniqueness

\* Liveness DISABLED: With message loss (LoseMessage action), liveness
\* requires strong fairness or bounded loss. Safety is the priority.
\*
\* PROPERTIES
\*     RekeyEventuallyHappens
\*     NoForeverWaiting
