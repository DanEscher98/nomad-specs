// NOMAD Protocol v1.0.0 Test Vectors
// Generated by specs/generate_vectors.py
// DO NOT EDIT - regenerate with: python specs/generate_vectors.py
//
// These vectors are the SOURCE OF TRUTH for all implementations.
// If your implementation doesn't match these values, your implementation is wrong.

{
  "_metadata": {
    "description": "Rekey test vectors for NOMAD v1.0 (PCS fix)",
    "generated": "2025-12-26T11:05:20.433005Z",
    "generator": "specs/generate_vectors.py",
    "protocol_version": "1.0.0"
  },
  "_notes": [
    "These vectors test the Post-Compromise Security (PCS) fix",
    "rekey_auth_key is derived from static DH during handshake",
    "New keys = HKDF(ephemeral_dh || rekey_auth_key, 'nomad v1 rekey' || LE32(epoch), 64)",
    "An attacker with only session keys cannot derive new rekey keys"
  ],
  "rekey_vectors": [
    {
      "name": "epoch_0_to_1",
      "description": "First rekey: transition from epoch 0 to epoch 1",
      "epoch": 1,
      "initiator_ephemeral": {
        "seed": "rekey-epoch1-initiator-ephemeral",
        "private_key": "60643863363835383438376661666164373931363830356332313765643466793436343566373634646461333464343639373639333838353934663535613761",
        "public_key": "368c31e9b505036662a4003b5e04aa571cef163bac01d51f6cab54af24cb4b3e"
      },
      "responder_ephemeral": {
        "seed": "rekey-epoch1-responder-ephemeral",
        "private_key": "30656235336234393338323664303065333238643935653337663337393861666339393136343164306464396666393336313537393830356333363739343937",
        "public_key": "968a592246f438dd8a2baf09f4abf9664a96025112a400a6cc7c5eb342c7bc34"
      },
      "ephemeral_dh": "813c560b94aec760c9a8d12a09bb4c2be3bfc35eb6983ceb264a13046d3aaa75",
      "rekey_auth_key": "e98774fbb11f0011d18d8823e3341e5edcd6c22943f7fec7d436eb9a42037e5b",
      "info": "6e6f6d61642076312072656b657901000000",
      "info_decoded": {
        "prefix": "nomad v1 rekey",
        "epoch_le32": 1
      },
      "new_initiator_key": "b8f7b06501c1186d95869c926a3c49e0d6638a03e3d4f108ab2d93d702b23627",
      "new_responder_key": "b86314cc912a4df80741859be2dea5d7ba0d817b605ef66217f762e5fa8250f3"
    },
    {
      "name": "epoch_1_to_2_pcs_case",
      "description": "Second rekey: epoch 1\u21922 (PCS test - attacker with epoch 1 keys cannot derive epoch 2)",
      "epoch": 2,
      "_pcs_note": "Even if attacker has epoch 1 keys, they need rekey_auth_key to compute epoch 2 keys",
      "initiator_ephemeral": {
        "seed": "rekey-epoch2-initiator-ephemeral",
        "private_key": "60393066643166633534353561373538636439303636653462343135393732786135336533393232396131313036313934316164623331303232316164643034",
        "public_key": "0d3702e6bb481b6e422337fde08cc19da88ee7864f186ad8cc0a170f6008172a"
      },
      "responder_ephemeral": {
        "seed": "rekey-epoch2-responder-ephemeral",
        "private_key": "60656530663234636463363633396665616264363639313864346463323335663637306264656333633261653639373732353562646461356431303264643132",
        "public_key": "3426424a80a34977901791d07bd580d0ed221cdf56c61a292e8528ac7479ea44"
      },
      "ephemeral_dh": "7efd5673c47236ad6f9bf85e945074615c1943c528a87cc0dc9084ad278d266e",
      "rekey_auth_key": "e98774fbb11f0011d18d8823e3341e5edcd6c22943f7fec7d436eb9a42037e5b",
      "info": "6e6f6d61642076312072656b657902000000",
      "info_decoded": {
        "prefix": "nomad v1 rekey",
        "epoch_le32": 2
      },
      "new_initiator_key": "e39ef4ea8f4f0715fd5d0c064972a4037ad93b2859a4e9f8799ad1fd328228ab",
      "new_responder_key": "06d90e4465d4006a56e13e207058ab78f18939bb0d09e469a6417e95b45dc8a6"
    },
    {
      "name": "epoch_high_number",
      "description": "High epoch number (100) - tests epoch encoding in info parameter",
      "epoch": 100,
      "initiator_ephemeral": {
        "seed": "rekey-epoch100-initiator-ephemeral",
        "private_key": "60663761306438386430323333353064616437363966336466383337663165736662353633336131656662336462303635333233623736303662306365666265",
        "public_key": "a6020713ef725c5815dec555b8d514ecc49fcc3ab5dcc5f62df0af255370cb7f"
      },
      "responder_ephemeral": {
        "seed": "rekey-epoch100-responder-ephemeral",
        "private_key": "60626636643131366538633831316461343530613835356366333761616363713966666665356139303838333464326535303266636630663830366336666130",
        "public_key": "d265cbd6d7c4aae7f69cbc60996f0eff87271e9fa32ebdad8caecd858685d87f"
      },
      "ephemeral_dh": "0038038a95c66833de6cd4a4743226d03d952d35d1885876f63b95deea271e3f",
      "rekey_auth_key": "e98774fbb11f0011d18d8823e3341e5edcd6c22943f7fec7d436eb9a42037e5b",
      "info": "6e6f6d61642076312072656b657964000000",
      "info_decoded": {
        "prefix": "nomad v1 rekey",
        "epoch_le32": 100
      },
      "new_initiator_key": "e0dfdeda09c64706d9723a5e185564f46b982790f65dcbb50ade43419e4b6a5c",
      "new_responder_key": "13939605c52b4cc19da9952cf32ae7419b0eabfe54c32099e9aedcffb0a545e0"
    }
  ],
  "intermediate_values": {
    "description": "Intermediate values for debugging implementations",
    "static_keys": {
      "initiator_static_private": "60626566333233326635353764633630366435353961343239373438323465773038623863616431626232333935383936666139306436643336633534386133",
      "initiator_static_public": "d2280ece32824e2d9d4257a0a70a7c5745e0cd2152376404f75e2bc367b67d60",
      "responder_static_private": "60666665323836383232343032326166643163636330623039643136613936743938363232376462346364633963363062336233343965636262636464313838",
      "responder_static_public": "c4f45ce2cb03853ca359acde14c04e76242c71e896e561765ad5d64a10f61e0c"
    },
    "static_dh": "57fbeea357c6ca4af3654988d78e020ccc6f4bc56db385bff4a46084b1187266",
    "rekey_auth_key": {
      "input": "57fbeea357c6ca4af3654988d78e020ccc6f4bc56db385bff4a46084b1187266",
      "info": "nomad v1 rekey auth",
      "output": "e98774fbb11f0011d18d8823e3341e5edcd6c22943f7fec7d436eb9a42037e5b"
    }
  }
}
