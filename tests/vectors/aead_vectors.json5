// NOMAD Protocol v1.0.0 Test Vectors
// Generated by specs/generate_vectors.py
// DO NOT EDIT - regenerate with: python specs/generate_vectors.py
//
// These vectors are the SOURCE OF TRUTH for all implementations.
// If your implementation doesn't match these values, your implementation is wrong.

{
  "_metadata": {
    "description": "XChaCha20-Poly1305 AEAD test vectors for NOMAD v1.0",
    "generated": "2025-12-25T20:21:39.178578Z",
    "generator": "specs/generate_vectors.py",
    "protocol_version": "1.0.0"
  },
  "_notes": [
    "All hex values are lowercase",
    "Nonce is 24 bytes (XChaCha20 extended nonce)",
    "Tag is 16 bytes (Poly1305)",
    "Ciphertext includes the tag appended"
  ],
  "vectors": [
    {
      "name": "basic_encryption",
      "description": "Basic AEAD encryption with minimal payload",
      "key": "3136363338353337376266373739316134383064396433396632313265653361",
      "nonce": "000000000000000000000000000000000000000000000000",
      "nonce_components": {
        "epoch": 0,
        "direction": 0,
        "counter": 0
      },
      "plaintext": "48656c6c6f2c204e4f4d414421",
      "plaintext_ascii": "Hello, NOMAD!",
      "aad": "03000102030405060000000000000000",
      "aad_components": {
        "frame_type": "0x03 (Data)",
        "flags": "0x00",
        "session_id": "010203040506",
        "nonce_counter": 0
      },
      "ciphertext": "04067a0165d0463eb935f8ac71f3d1558bf3d3beca3c1e254031e1b8b3",
      "tag": "f3d1558bf3d3beca3c1e254031e1b8b3"
    },
    {
      "name": "empty_plaintext_ack_only",
      "description": "AEAD with empty plaintext (ack-only frame)",
      "key": "3136363338353337376266373739316134383064396433396632313265653361",
      "nonce": "000000000000000000000000000000000100000000000000",
      "nonce_components": {
        "epoch": 0,
        "direction": 0,
        "counter": 1
      },
      "plaintext": "",
      "aad": "03010102030405060100000000000000",
      "aad_components": {
        "frame_type": "0x03 (Data)",
        "flags": "0x01 (ACK_ONLY)",
        "session_id": "010203040506",
        "nonce_counter": 1
      },
      "ciphertext": "8e567d4cfce1461492fc7b6cff3919d0",
      "tag": "8e567d4cfce1461492fc7b6cff3919d0"
    },
    {
      "name": "responder_direction",
      "description": "AEAD with responder->initiator direction",
      "key": "3732313939653831623930643565376436653133623961643265316333643634",
      "nonce": "000000000100000000000000000000000000000000000000",
      "nonce_components": {
        "epoch": 0,
        "direction": 1,
        "counter": 0
      },
      "plaintext": "526573706f6e73652066726f6d20736572766572",
      "aad": "03000102030405060000000000000000",
      "ciphertext": "06c52db83eaf0abba6707e6bf333730887b007e0d91510b043defe33c7a1a641a14e532e"
    },
    {
      "name": "after_rekey_epoch_1",
      "description": "AEAD after first rekey (epoch=1, counter reset to 0)",
      "key": "6332623333396163323362636431346439303238356132623533313432396534",
      "nonce": "010000000000000000000000000000000000000000000000",
      "nonce_components": {
        "epoch": 1,
        "direction": 0,
        "counter": 0
      },
      "plaintext": "41667465722072656b6579",
      "aad": "03000102030405060000000000000000",
      "ciphertext": "9cf2d7651354f6c803acafe8bff4f9cc111862b68ab6c36b1651df"
    },
    {
      "name": "high_counter_value",
      "description": "AEAD with high counter value (4 billion)",
      "key": "3136363338353337376266373739316134383064396433396632313265653361",
      "nonce": "00000000000000000000000000000000ffffffff00000000",
      "nonce_components": {
        "epoch": 0,
        "direction": 0,
        "counter": 4294967295
      },
      "plaintext": "4869676820636f756e746572",
      "aad": "0300aabbccddeeffffffffff00000000",
      "ciphertext": "569e2b1ab2fd71c7c4a3643546ee08909254269606af91ae7c0cdb16"
    }
  ]
}
